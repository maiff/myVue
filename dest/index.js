'use strict';

Object.defineProperty(exports, '__esModule', { value: true });

// const aryMethods = ['push', 'pop', 'shift', 'unshift', 'splice', 'sort', 'reverse']
class MyArray extends Array {
  push (...args) {
    console.log('我被改变了');
    let length = super.push(...args);
    new Observer(this);
    return length
  }
}

class Observer {
  constructor (data) {
    this.data = data;
    this.walk(data);
  }

  walk (obj) {
    let val;
    for (let key in obj) {
      if (obj.hasOwnProperty(key)) {
        if (obj[key]['__isConvert__']) return
        val = obj[key];
        if (Array.isArray(val)) {
          obj[key] = new MyArray(...val);
          val = obj[key];
        }
        if (typeof val === 'object') {
          new Observer(val);
        }

        this.convert(key, val);
      }
    }
  }

  convert (key, val) {
    this.data[key]['__isConvert__'] = true;
    Object.defineProperty(this.data, key, {
      enumerable: true,
      configurable: true,
      get: function () {
        console.log('你访问了' + key);
        return val
      },
      set: function (newVal) {
        console.log('你设置了' + key);
        console.log('新的' + key + ' = ' + newVal);
        if (newVal === val) return
        val = newVal;
      }
    });
  }
}
new Observer();

exports.Observer = Observer;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VzIjpbIi4uL3NyYy9vYnNlcnZlci9teUFycmF5LmpzIiwiLi4vc3JjL29ic2VydmVyL09ic2VydmVyLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIGNvbnN0IGFyeU1ldGhvZHMgPSBbJ3B1c2gnLCAncG9wJywgJ3NoaWZ0JywgJ3Vuc2hpZnQnLCAnc3BsaWNlJywgJ3NvcnQnLCAncmV2ZXJzZSddXG5pbXBvcnQgT2JzZXJ2ZXIgZnJvbSAnLi9PYnNlcnZlcidcbmNsYXNzIE15QXJyYXkgZXh0ZW5kcyBBcnJheSB7XG4gIHB1c2ggKC4uLmFyZ3MpIHtcbiAgICBjb25zb2xlLmxvZygn5oiR6KKr5pS55Y+Y5LqGJylcbiAgICBsZXQgbGVuZ3RoID0gc3VwZXIucHVzaCguLi5hcmdzKVxuICAgIG5ldyBPYnNlcnZlcih0aGlzKVxuICAgIHJldHVybiBsZW5ndGhcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBNeUFycmF5XG4iLCJpbXBvcnQgTXlBcnJheSBmcm9tICcuL215QXJyYXknXG5jbGFzcyBPYnNlcnZlciB7XG4gIGNvbnN0cnVjdG9yIChkYXRhKSB7XG4gICAgdGhpcy5kYXRhID0gZGF0YVxuICAgIHRoaXMud2FsayhkYXRhKVxuICB9XG5cbiAgd2FsayAob2JqKSB7XG4gICAgbGV0IHZhbFxuICAgIGZvciAobGV0IGtleSBpbiBvYmopIHtcbiAgICAgIGlmIChvYmouaGFzT3duUHJvcGVydHkoa2V5KSkge1xuICAgICAgICBpZiAob2JqW2tleV1bJ19faXNDb252ZXJ0X18nXSkgcmV0dXJuXG4gICAgICAgIHZhbCA9IG9ialtrZXldXG4gICAgICAgIGlmIChBcnJheS5pc0FycmF5KHZhbCkpIHtcbiAgICAgICAgICBvYmpba2V5XSA9IG5ldyBNeUFycmF5KC4uLnZhbClcbiAgICAgICAgICB2YWwgPSBvYmpba2V5XVxuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlb2YgdmFsID09PSAnb2JqZWN0Jykge1xuICAgICAgICAgIG5ldyBPYnNlcnZlcih2YWwpXG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmNvbnZlcnQoa2V5LCB2YWwpXG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgY29udmVydCAoa2V5LCB2YWwpIHtcbiAgICB0aGlzLmRhdGFba2V5XVsnX19pc0NvbnZlcnRfXyddID0gdHJ1ZVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLmRhdGEsIGtleSwge1xuICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICBjb25zb2xlLmxvZygn5L2g6K6/6Zeu5LqGJyArIGtleSlcbiAgICAgICAgcmV0dXJuIHZhbFxuICAgICAgfSxcbiAgICAgIHNldDogZnVuY3Rpb24gKG5ld1ZhbCkge1xuICAgICAgICBjb25zb2xlLmxvZygn5L2g6K6+572u5LqGJyArIGtleSlcbiAgICAgICAgY29uc29sZS5sb2coJ+aWsOeahCcgKyBrZXkgKyAnID0gJyArIG5ld1ZhbClcbiAgICAgICAgaWYgKG5ld1ZhbCA9PT0gdmFsKSByZXR1cm5cbiAgICAgICAgdmFsID0gbmV3VmFsXG4gICAgICB9XG4gICAgfSlcbiAgfVxufVxubmV3IE9ic2VydmVyKClcbmV4cG9ydCBkZWZhdWx0IE9ic2VydmVyXG4iXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBO0FBQ0EsQUFDQSxNQUFNLE9BQU8sU0FBUyxLQUFLLENBQUM7RUFDMUIsSUFBSSxDQUFDLENBQUMsR0FBRyxJQUFJLEVBQUU7SUFDYixPQUFPLENBQUMsR0FBRyxDQUFDLE9BQU8sQ0FBQyxDQUFBO0lBQ3BCLElBQUksTUFBTSxHQUFHLEtBQUssQ0FBQyxJQUFJLENBQUMsR0FBRyxJQUFJLENBQUMsQ0FBQTtJQUNoQyxJQUFJLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQTtJQUNsQixPQUFPLE1BQU07R0FDZDtDQUNGLEFBRUQsQUFBc0I7O0FDVnRCLE1BQU0sUUFBUSxDQUFDO0VBQ2IsV0FBVyxDQUFDLENBQUMsSUFBSSxFQUFFO0lBQ2pCLElBQUksQ0FBQyxJQUFJLEdBQUcsSUFBSSxDQUFBO0lBQ2hCLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUE7R0FDaEI7O0VBRUQsSUFBSSxDQUFDLENBQUMsR0FBRyxFQUFFO0lBQ1QsSUFBSSxHQUFHLENBQUE7SUFDUCxLQUFLLElBQUksR0FBRyxJQUFJLEdBQUcsRUFBRTtNQUNuQixJQUFJLEdBQUcsQ0FBQyxjQUFjLENBQUMsR0FBRyxDQUFDLEVBQUU7UUFDM0IsSUFBSSxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUMsZUFBZSxDQUFDLEVBQUUsTUFBTTtRQUNyQyxHQUFHLEdBQUcsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFBO1FBQ2QsSUFBSSxLQUFLLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxFQUFFO1VBQ3RCLEdBQUcsQ0FBQyxHQUFHLENBQUMsR0FBRyxJQUFJLE9BQU8sQ0FBQyxHQUFHLEdBQUcsQ0FBQyxDQUFBO1VBQzlCLEdBQUcsR0FBRyxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUE7U0FDZjtRQUNELElBQUksT0FBTyxHQUFHLEtBQUssUUFBUSxFQUFFO1VBQzNCLElBQUksUUFBUSxDQUFDLEdBQUcsQ0FBQyxDQUFBO1NBQ2xCOztRQUVELElBQUksQ0FBQyxPQUFPLENBQUMsR0FBRyxFQUFFLEdBQUcsQ0FBQyxDQUFBO09BQ3ZCO0tBQ0Y7R0FDRjs7RUFFRCxPQUFPLENBQUMsQ0FBQyxHQUFHLEVBQUUsR0FBRyxFQUFFO0lBQ2pCLElBQUksQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsZUFBZSxDQUFDLEdBQUcsSUFBSSxDQUFBO0lBQ3RDLE1BQU0sQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLElBQUksRUFBRSxHQUFHLEVBQUU7TUFDcEMsVUFBVSxFQUFFLElBQUk7TUFDaEIsWUFBWSxFQUFFLElBQUk7TUFDbEIsR0FBRyxFQUFFLFlBQVk7UUFDZixPQUFPLENBQUMsR0FBRyxDQUFDLE1BQU0sR0FBRyxHQUFHLENBQUMsQ0FBQTtRQUN6QixPQUFPLEdBQUc7T0FDWDtNQUNELEdBQUcsRUFBRSxVQUFVLE1BQU0sRUFBRTtRQUNyQixPQUFPLENBQUMsR0FBRyxDQUFDLE1BQU0sR0FBRyxHQUFHLENBQUMsQ0FBQTtRQUN6QixPQUFPLENBQUMsR0FBRyxDQUFDLElBQUksR0FBRyxHQUFHLEdBQUcsS0FBSyxHQUFHLE1BQU0sQ0FBQyxDQUFBO1FBQ3hDLElBQUksTUFBTSxLQUFLLEdBQUcsRUFBRSxNQUFNO1FBQzFCLEdBQUcsR0FBRyxNQUFNLENBQUE7T0FDYjtLQUNGLENBQUMsQ0FBQTtHQUNIO0NBQ0Y7QUFDRCxJQUFJLFFBQVEsRUFBRSxDQUFBLEFBQ2QsQUFBdUIsOzsifQ==
